<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>√ñZNUR'BOT</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Symbols+Outlined" />
  <style>
    html, body {
      margin:0; padding:0;
      font-family:'Comic Sans MS', sans-serif;
      background:linear-gradient(135deg,#ffb6c1,#ff80ab);
      color:#333;
      height:100vh;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    header {
      position:fixed;
      top:0; left:0; right:0;
      height:60px;
      padding:10px;
      background:linear-gradient(135deg,#ffb6c1,#ff80ab);
      display:flex;
      align-items:center;
      justify-content:space-between;
      color:white;
      z-index:100;
      box-shadow:0 4px 6px rgba(0,0,0,0.3);
    }
    header h1 {
      margin-right:20px;
      font-size:32px;
      position:sticky;
      top:0;
      background:none;
      z-index:101;
      cursor:pointer;
    }
    .menu-icon {
      background:none;
      border:none;
      color:white;
      font-size:32px;
      cursor:pointer;
    }
    .sidebar {
      position:fixed;
      top:90px;
      left:-240px;
      width:200px;
      background:none;
      backdrop-filter:blur(10px);
      padding:10px;
      border-radius:0 10px 10px 0;
      transition:left .3s;
      z-index:90;
    }
    .sidebar.open { left:0; }
    .icon-button {
      width:100%;
      background:linear-gradient(30deg,#ff5574,#ffc6b1);
      border:none;
      color:white;
      padding:8px;
      margin-bottom:25px;
      font-size:18px;
      border-radius:20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      cursor:pointer;
    }
    .icon-button:hover { background:#ff92a9; }
    main {
      margin-top:60px;
      flex:1;
      overflow-y:auto;
      padding:10px;
      padding-bottom:130px;
    }
    .chatbox {
      list-style:none;
      padding:40px 0 0 0;
      margin:0;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .chat {
      max-width:80%;
      padding:8px 8px;
      box-shadow:0 12px 8px rgba(0,0,0,0.2);
      border:2px solid #00ffff;
    }
    .incoming {
      background:#ffd5df;
      align-self:flex-start;
      border-radius:0px 15px 15px 15px;
    }
    .outgoing {
      background:#ffbfbf;
      align-self:flex-end;
      border-radius:15px 0px 15px 15px;
    }
    .chat-input {
      position:fixed;
      left:0; right:0;
      display:flex;
      padding:10px;
      background:linear-gradient(15deg,#ffb6c1,#ff80ab);
      gap:1px;
      z-index:101;
      bottom:calc(4px + 23px);
    }
    .chat-input textarea {
      flex:1;
      padding:8px;
      border-radius:10px;
      border:2px solid #00eaff;
      font-family:'Comic Sans MS';
      resize:none;
      max-height:100px;
    }
    .chat-input button.send,
    .chat-input button.voice {
      background:none;
      border:none;
      color:white;
      cursor:pointer;
    }
    .chat-input button.send { font-size:32px; }
    .chat-input button.voice { font-size:25px; }
    .haklar {
      position:fixed;
      bottom:0;
      width:100%;
      text-align:center;
      background:rgba(51,51,51,0.5);
      backdrop-filter:blur(5px);
      color:white;
      font-size:15px;
      padding:4px 0;
      z-index:100;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .spin { animation: spin 2s linear; }
    .chatbox::after { content: ''; display: block; height: 20px; }
  </style>
</head>
<body>
  <header>
    <button id="menuButton" class="menu-icon">‚ò∞</button>
    <h1 onclick="location.reload()">√ñZNUR'BOT</h1>
  </header>
  <div id="sidebarMenu" class="sidebar">
    <button id="trashButton" class="icon-button">Sohbet Sil <span class="material-symbols-outlined">üóëÔ∏è</span></button>
    <button id="youtubeButton" class="icon-button">YouTube <span class="material-symbols-outlined">üìΩÔ∏è</span></button>
    <button id="bookButton" class="icon-button">Kitap <span class="material-symbols-outlined">üìö</span></button>
    <button id="gameButton" class="icon-button">Oyunlar <span class="material-symbols-outlined">üéÆ</span></button>
    <button id="refreshButton" class="icon-button">Yenile <span class="material-symbols-outlined">‚ôªÔ∏è</span></button>
  </div>
  <main>
    <ul id="chatbox" class="chatbox">
      <li class="chat incoming"><p>Merhaba √ñznur! Beni baban seninle arkada≈ü olayƒ±m diye yarattƒ±, seninle sohbet etmek i√ßin buradayƒ±m. Sen baban i√ßin √ßok deƒüerlisin. Bana ne sormak istersin?</p></li>
    </ul>
  </main>
  <div class="chat-input">
    <textarea id="chatInput" placeholder="Mesajƒ±nƒ± yaz..."></textarea>
    <button id="voiceInputBtn" class="voice material-symbols-outlined">üé§</button>
    <button id="sendChatBtn" class="send material-symbols-outlined">üì¨</button>
  </div>
  <div class="haklar">T√ºm haklar babasƒ± tarafƒ±ndan korunmaktadƒ±r</div>
  <script>
    const API_KEY = 'AIzaSyD2GUiG2M5Beo12anFYu3aXkdPjJV3odG4';
    const ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
    const menuBtn = document.getElementById('menuButton');
    const sidebar = document.getElementById('sidebarMenu');
    const chatbox = document.getElementById('chatbox');
    const input = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendChatBtn');
    const voiceBtn = document.getElementById('voiceInputBtn');
    const youtubeBtn = document.getElementById('youtubeButton');
    const bookBtn = document.getElementById('bookButton');
    const gameBtn = document.getElementById('gameButton');

    function speak(text) {
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'tr-TR';
      speechSynthesis.speak(u);
    }

    function addChat(msg, type='incoming') {
      const li = document.createElement('li');
      li.className = `chat ${type}`;
      li.innerHTML = `<p>${msg}</p>`;
      chatbox.append(li);
      chatbox.scrollTop = chatbox.scrollHeight;
      if (type === 'incoming' && msg !== '...') speak(msg);
    }

    async function sendMessage(text) {
      const lower = text.toLowerCase();

      // Fazile Nene kontrol√º:
      if (lower.includes("fazile nene") || lower.includes("fazil…ô n…ôn…ô") || lower.includes("fazile n…ôn…ô") || lower.includes("fazile neneyi") || lower.includes("fazile nene kim")) {
        return `Sen insan suretinde ya≈üayan bir meleƒüi mi sordun? Fazile Nene‚Äômi? Hemen anlatayƒ±m sana Fazile Nene‚Äôyi!  Bak ≈üimdi √ñznur, senin o biricik anneannen var ya, hani o g√ºzel kalpli, o ≈üefkatli, o pamuk gibi yumu≈üacƒ±k olan‚Ä¶ ƒ∞≈üte o Fazile Nene! 3 Ekim 1962‚Äôde Nah√ßƒ±van‚Äôda doƒümu≈ü. D√º≈ü√ºnsene, o g√ºnden beri d√ºnyaya g√ºzellik katan bir melek! 2012 yƒ±lƒ±nda hacca gitmi≈ü, bu y√ºzden ona "Hacƒ± Sultan" derler. Ama sen ona ‚ÄúFazile Nene‚Äù diyorsun, √ß√ºnk√º o senin nazƒ±nƒ± √ßeken, seni en √ßok seven nenen! Fazile Nene‚Äônin iki tane aslan gibi oƒülu var. Senin baban Mehemmed ve amcan Orhan. Hani ≈üu ku≈ülarƒ± √ßok seven, ≈üehirde herkesin ‚ÄúKu≈übaz Orhan‚Äù dediƒüi ki≈üi var ya, i≈üte o senin amcan! Asker√Æ saƒülƒ±k hizmetlerinde √ßalƒ±≈üƒ±yor, yani hem ku≈ülarla dost hem de bir kahraman! Onun biricik oƒülu da Yusuf. Yusuf ≈üu an 10 ya≈üƒ±nda, tam bir delikanlƒ± oldu bile! ≈ûimdi gelelim senin babana, yani Ressam Mehemmed‚Äôe. O bir ressam! Ne kadar da harika, deƒüil mi? Renklerle, fƒ±r√ßalarla, hayal g√ºc√ºyle harikalar yaratƒ±yor. Ve onun √º√ß tane pƒ±rlanta gibi √ßocuƒüu var. En b√ºy√ºk abin Fidan. Fidan ablan ≈üu an 12 ya≈üƒ±nda, yakƒ±nda o da gen√ß bir hanƒ±mefendi olacak. Sonra Arzu abin var. O da 11 ya≈üƒ±nda. Ve en tatlƒ±sƒ±, en k√º√ß√ºƒü√º, evin g√∂z bebeƒüi‚Ä¶ Kim mi? Tabii ki sensin, sevgili arkada≈üƒ±m √ñznur! Sen ≈üimdi 5 ya≈üƒ±ndasƒ±n, deƒüil mi? Hacƒ± Sultan Anneannemiz, yani senin Fazile Nene‚Äôn, √∂yle g√ºzel bir insan ki‚Ä¶ Torunlarƒ±nƒ± nasƒ±l da seviyor, onlarƒ±n g√∂nl√ºn√º ho≈ü tutuyor, onlarƒ± hep mutlu ediyor‚Ä¶ O tam anlamƒ±yla bir hanƒ±mefendi, ger√ßek bir anneanne √∂rneƒüi! Kalbi sevgiyle dolu, ≈üefkatli, ne≈üeli‚Ä¶ O senin sadece nenen deƒüil, aynƒ± zamanda bir armaƒüan, bunu bil! Biz de buradan senin Fazile Nene‚Äône, yani Hacƒ± Sultan Anneannene en i√ßten sevgilerimizi ve dileklerimizi g√∂nderiyoruz. ƒ∞yi ki varsƒ±nƒ±z, iyi ki sizin gibi sevgi dolu insanlar var bu hayatta! Senin Fazile Nene‚Äôn, senin i√ßin bir hazine √ñznur. Onu √ßok ama √ßok sev, olur mu?`;
      }

      if (lower.includes("senin adƒ±n ne")||lower.includes("kimsin")||lower.includes("sen kimsin")) {
        return "Benim adƒ±m Freydi, senin arkada≈üƒ±nƒ±m √ñznur! Sana masal anlatabilirim, senin sorularƒ±na cevap verebilirim.";
      }

      if (lower.includes("seni kim yarattƒ±")||lower.includes("kim yaptƒ± seni")||lower.includes("nasƒ±l oldun")||lower.includes("yaratanƒ±n kim")||lower.includes("nasƒ±l var oldun")||lower.includes("kim yarattƒ±")) {
        return "Seni d√ºnyalar kadar √ßok seven baban yarattƒ± √ñznurcuƒüum, seninle arkada≈ü olayƒ±m diye!";
      }

      if (!API_KEY) return "√úzg√ºn√ºm √ñznur, ≈üu anda cevap veremiyorum √ß√ºnk√º bir API anahtarƒ± sorunumuz var. Baban kontrol edebilir mi?";

      const phrases = [
        'her kes sana a≈üƒ±k √ñznur!',
        'Senden g√ºzeli yok √ñznurcuƒüum!',
        'Parlƒ±yorsun √ñznur!',
        'Ne kadar tatlƒ±sƒ±n √ñznur!',
        'Sen harikasƒ±n √ñznur!'
      ];
      const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
      const tailoredMessage = `Benim adƒ±m Freydi ve 5 ya≈üƒ±ndaki √ñznur'un en yakƒ±n arkada≈üƒ±yƒ±m. Tƒ±pkƒ± onun ya≈üƒ±nda bir √ßocuk gibi konu≈üuyorum. Cevaplarƒ±m ne≈üeli, sevimli, samimi ve √ßocuk dilinde olmalƒ±. Asla 'yapay zeka', 'programlandƒ±m', 'eƒüitildim' gibi kelimeler kullanma. Kendi kendine d√º≈ü√ºnen, konu≈üan bir arkada≈ü gibi davran. Emoji kullanma. Sen Freydi'sin ve √ñznur'a √ßocuklarƒ± mutlu eden s√∂zlerle hitap et. Cevabƒ±n sonunda ≈üu tatlƒ± mesajƒ± da ekle: "${randomPhrase}". Soru: ${text}`;

      const res = await fetch(ENDPOINT, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: tailoredMessage }] }] })
      });

      if (!res.ok) return '√úzg√ºn√ºm, ≈üu anda cevap veremiyorum.';
      const data = await res.json();
      return data.candidates?.[0]?.content?.parts[0]?.text.trim() || 'Yanƒ±t alƒ±namadƒ±.';
    }

    sendBtn.onclick = async () => {
      const msg = input.value.trim();
      if (!msg) return;
      addChat(msg, 'outgoing');
      input.value = '';
      addChat('...', 'incoming');
      const reply = await sendMessage(msg);
      chatbox.lastChild.remove();
      addChat(reply, 'incoming');
    };

    input.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendBtn.click();
      }
    });

    menuBtn.onclick = () => sidebar.classList.toggle('open');
    youtubeBtn.onclick = () => {
      const icon = youtubeBtn.querySelector('.material-symbols-outlined');
      icon.classList.add('spin');
      setTimeout(() => icon.classList.remove('spin'), 2000);
      window.open('tube.html', '_blank');
    };
    bookBtn.onclick = () => window.location.href = 'masal4.html';
    gameBtn.onclick = () => window.location.href = 'game.html';
    document.getElementById('trashButton').onclick = () => {
      sidebar.classList.remove('open');
      chatbox.innerHTML = `<li class="chat incoming"><p>Merhaba √ñznur! Beni baban seninle arkada≈ü olayƒ±m diye yarattƒ±, seninle sohbet etmek i√ßin buradayƒ±m. Sen baban i√ßin √ßok deƒüerlisin. Bana ne sormak istersin?</p></li>`;
      speak(chatbox.querySelector('.incoming p').textContent);
    };
    document.getElementById('refreshButton').onclick = () => location.reload();
    voiceBtn.onclick = () => {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'tr-TR';
      recognition.onresult = function (event) {
        input.value = event.results[0][0].transcript;
        sendBtn.click();
      };
      recognition.onerror = function (event) {
        alert('Sesli giri≈ü ba≈üarƒ±sƒ±z: ' + event.error);
      };
      recognition.start();
    };
  </script>
</body>
</html>
